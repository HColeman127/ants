(()=>{'use strict';function t(){var i,h=performance.now();for(0!==e.i.t&&(r.h?s.o(r.u,e.i.M,e.i.t):r.v&&s.o(r.u,e.i.M,0)),i=0;o>i;i++)s.m(),s.l();e.p(s),e.k(s.A),e.g(r.u),(t=>{var i=performance.now()-t;n.innerHTML=(a=.95*a+.05*i).toFixed(2)+'ms'})(h),window.requestAnimationFrame(t)}var i,h,n,s,e,r,a,o;const u=function(){function t(t,i){this.x=t,this.y=i}return Object.defineProperty(t.prototype,'_',{get(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},U:!1,I:!0}),Object.defineProperty(t.prototype,'j',{get(){return this.C(1/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)))},U:!1,I:!0}),t.prototype.C=function(i){return new t(i*this.x,i*this.y)},t.prototype.O=function(t){return this.C(t/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)))},t.prototype.trunc=function(){return new t(Math.trunc(this.x),Math.trunc(this.y))},t.prototype.D=function(t){void 0===t&&(t=1);var i=Math.pow(this.x,2)+Math.pow(this.y,2);return i>Math.pow(t,2)?this.C(t/Math.sqrt(i)):this},t.prototype.q=function(i){return new t(this.x+i.x,this.y+i.y)},t.prototype.B=function(i){return new t(this.x-i.x,this.y-i.y)},t.prototype.F=function(t){return this.x*t.x+this.y*t.y},t.G=i=>(void 0===i&&(i=1),new t(i*(2*Math.random()-1),i*(2*Math.random()-1))),t.H=new t(0,0),t.J=new t(1,1),t.K=new t(1,0),t.L=new t(0,1),t}(),f=(()=>{function t(){}return t.N=t=>Math.trunc(t.x)+500*Math.trunc(t.y),t.P=(t,i,h)=>Math.max(i,Math.min(h,t)),t.R=t=>t>0?1:0>t?-1:0,t.S=(t,i,h)=>{var n,s,e=Math.pow(i,2);for(n=Math.max(0,Math.trunc(t.y)-i);n<Math.min(375,Math.trunc(t.y)+i);n++)for(s=Math.max(0,Math.trunc(t.x)-i);s<Math.min(500,Math.trunc(t.x)+i);s++)e>Math.pow(t.x-s,2)+Math.pow(t.y-n,2)&&h(s,n)},t})(),c=function(){function t(t,i){this.T=!1,this.V=0,this.W=0,this.u=t,this.X=i,this.Y=i}return t.Z=()=>{var t,i,h,n,s,e,r,a,o=[];for(t=-20;20>=t;t++)for(i=-20;20>=i;i++)Math.pow(t,2)+Math.pow(i,2)>400||o.push(new u(t,i));for(o.sort(((t,i)=>t._-i._)),h=o.length,n=new Int8Array(h),s=new Int8Array(h),e=new Uint32Array(h),r=0;h>r;r++)n[r]=(a=o[r]).x,s[r]=a.y,e[r]=a.x+500*a.y;return{$:o,size:h,dx:n,dy:s,tt:e}},t.prototype.it=function(t){var i,h=this.ht(t);h.F(this.X)>0&&(this.Y=this.Y.q(h.O(.1))),this.Y=this.Y.q(u.G(.1)).j,i=this.Y.B(this.X).C(.5),this.X=this.X.q(i).D()},t.prototype.ht=function(i){var h,n,s,e,r=Math.trunc(this.u.x),a=Math.trunc(this.u.y),o=0,f=r,c=a;for(h=0;t.view.size>h;h++)s=a+t.view.dy[h],(n=r+t.view.dx[h])>=0&&500>n&&(e=i[n+500*s])>o&&(o=e,f=n,c=s);return new u(f-r,c-a)},t.prototype.nt=function(t){var i,h=this.u.q(this.X);50>h.x&&50>h.y&&(this.T=!1,this.V=255),0>h.x||h.x>500||0>h.y||h.y>375?this.st():(i=h.trunc(),1!==t[f.N(i)]?(2!==t[f.N(i)]||this.T||(t[f.N(i)]=0,this.T=!0,this.V=255,this.Y=this.X.C(-1)),this.u=new u(f.P(h.x,0,500),f.P(h.y,0,375)),this.W=0):this.st())},t.prototype.st=function(){this.u=this.u.B(this.X),this.Y=u.H,this.W++,this.W>100&&(this.u=new u(20,20))},t.prototype.et=function(t){var i=f.N(this.u);t[i]=Math.max(t[i],Math.trunc(this.V))},t.prototype.rt=function(){this.V=Math.max(0,this.V-.125)},t.view=t.Z(),t}(),w=function(){function t(){this.A=[];for(var t=0;1e3>t;t++)this.A.push(new c(new u(25,25),u.G()));this.at=new Uint8ClampedArray(187500),this.ot=new Uint8ClampedArray(187500),this.ut=new Uint8Array(187500)}return t.prototype.m=function(){for(var t=0;187500>t;t++)0===this.at[t]&&0===this.ot[t]||Math.random()>=.005||(this.at[t]=0,this.ot[t]=0)},t.prototype.l=function(){var t,i;for(t=0;1e3>t;t++)(i=this.A[t]).it(i.T?this.at:this.ot),i.nt(this.ut),i.et(i.T?this.ot:this.at),i.rt()},t.prototype.o=function(t,i,h){var n=this;f.S(t,i,((t,i)=>{var s=t+500*i;n.ut[s]=h,n.at[s]=0,n.ot[s]=0}))},t}();i=function(){function t(t){this.element=t,this.u=u.H,this.h=!1,this.v=!1,this.ft()}return t.prototype.ft=function(){var t=this;this.element.addEventListener('mousedown',(i=>{t.h||(t.h=0===i.button),t.v||(t.v=2===i.button)})),window.addEventListener('mousemove',(i=>{var h=t.element.getBoundingClientRect();t.u=new u(i.clientX-h.left,i.clientY-h.top)})),window.addEventListener('mouseup',(i=>{t.h&&(t.h=!(0===i.button)),t.v&&(t.v=!(2===i.button))}))},t}();const M=function(){function t(t){this.canvas=document.getElementById(t),this.ct=this.canvas.getContext('2d'),this.wt=new ImageData(500,500),this.i=new h(30,0),this.Mt(),this.dt(),this.vt()}return t.prototype.Mt=function(){this.canvas.width=500,this.canvas.height=375,this.canvas.addEventListener('contextmenu',(t=>t.preventDefault())),this.canvas.addEventListener('wheel',(t=>t.preventDefault()))},t.prototype.dt=function(){for(var t=3;75e4>t;t+=4)this.wt.data[t]=255},t.prototype.vt=function(){var t=this;this.canvas.addEventListener('wheel',(i=>{t.i.M=f.P(t.i.M-f.R(i.deltaY),0,100)}))},t.prototype.p=function(t){var i,h,n=this.wt.data;for(i=0;187500>i;i++)h=4*i,1===t.ut[i]?(n[h]=100,n[h+1]=100,n[h+2]=100):2===t.ut[i]?(n[h]=0,n[h+1]=0,n[h+2]=255):(n[h]=t.at[i],n[h+1]=0,n[h+2]=t.ot[i]);this.ct.putImageData(this.wt,0,0),this.ct.fillStyle='#ff0000',this.ct.fillRect(0,0,50,50)},t.prototype.k=function(t){var i,h,n;for(this.ct.strokeStyle='#ffffff',this.ct.beginPath(),i=0;1e3>i;i++)h=t[i].u,n=t[i].X.O(1.5),this.ct.moveTo(h.x-n.x,h.y-n.y),this.ct.lineTo(h.x+n.x,h.y+n.y);this.ct.stroke()},t.prototype.g=function(t){0!==this.i.t&&(this.ct.strokeStyle='#999999',this.ct.beginPath(),this.ct.arc(t.x,t.y,this.i.M,0,2*Math.PI),this.ct.stroke(),this.ct.fillStyle='#ffffff',this.ct.fillText('brush: '+{0:'none',1:'wall',2:'food'}[this.i.t],10,365))},t}();h=function(){function t(t,i){this.M=t,this.t=i,this.vt()}return t.prototype.vt=function(){var t=this;document.getElementById('button_none').addEventListener('click',(()=>t.t=0)),document.getElementById('button_wall').addEventListener('click',(()=>t.t=1)),document.getElementById('button_food').addEventListener('click',(()=>t.t=2)),window.addEventListener('keydown',(i=>{switch(i.key){case'0':t.t=0;break;case'1':t.t=1;break;case'2':t.t=2}}))},t}(),a=0,o=0,window.addEventListener('load',(()=>{n=document.getElementById('p1'),s=new w,e=new M('canvas'),r=new i(e.canvas),document.getElementById('button_play').addEventListener('click',(()=>o++)),document.getElementById('button_pause').addEventListener('click',(()=>o=0)),t()}))})();