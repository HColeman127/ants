(()=>{'use strict';function t(){var i,h=performance.now();for(i=0;a>i;i++)s.update();e.t(s),0!==e.h.i&&(e.o(o.u),o.M?s.v(o.u,e.h.m,e.h.i):o.l&&s.v(o.u,e.h.m,0)),r=.95*r+.05*(performance.now()-h),n.innerHTML=r.toFixed(2)+'ms',window.requestAnimationFrame(t)}var i,h,n,s,e,o,r,a,u;const f=function(){function t(t,i){this.x=t,this.y=i}return Object.defineProperty(t.prototype,'p',{get(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},k:!1,g:!0}),Object.defineProperty(t.prototype,'A',{get(){return this._(1/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)))},k:!1,g:!0}),t.prototype._=function(i){return new t(i*this.x,i*this.y)},t.prototype.I=function(t){return this._(t/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)))},t.prototype.trunc=function(){return new t(Math.trunc(this.x),Math.trunc(this.y))},t.prototype.U=function(t){void 0===t&&(t=1);var i=Math.pow(this.x,2)+Math.pow(this.y,2);return i>Math.pow(t,2)?this._(t/Math.sqrt(i)):this},t.prototype.j=function(i){return new t(this.x+i.x,this.y+i.y)},t.prototype.C=function(i){return new t(this.x-i.x,this.y-i.y)},t.prototype.O=function(t){return this.x*t.x+this.y*t.y},t.D=i=>(void 0===i&&(i=1),new t(i*(2*Math.random()-1),i*(2*Math.random()-1))),t.q=new t(0,0),t.B=new t(1,1),t.F=new t(1,0),t.G=new t(0,1),t}();i=(()=>{function t(){}return t.H=t=>Math.trunc(t.x)+500*Math.trunc(t.y),t.J=(t,i,h)=>Math.max(i,Math.min(h,t)),t.K=t=>t>0?1:0>t?-1:0,t.L=(t,i,h)=>{var n,s,e=Math.pow(i,2);for(n=Math.max(0,Math.trunc(t.y)-i);n<Math.min(375,Math.trunc(t.y)+i);n++)for(s=Math.max(0,Math.trunc(t.x)-i);s<Math.min(500,Math.trunc(t.x)+i);s++)e>Math.pow(t.x-s,2)+Math.pow(t.y-n,2)&&h(s,n)},t})();const c=function(){function t(t,i){this.N=!1,this.P=0,this.R=0,this.u=t,this.S=i,this.T=i}return t.prototype.V=function(i){var h,n,s,e,o,r=Math.trunc(this.u.x),a=Math.trunc(this.u.y),u=0,c=r,w=a;for(h=0;t.view.size>h;h++)s=a+t.view.dy[h],(n=r+t.view.dx[h])>=0&&500>n&&(e=i[n+500*s])>u&&(u=e,c=n,w=s);(o=new f(c-r,w-a)).O(this.S)>0&&(this.T=this.T.j(o.I(.1))),this.T=this.T.j(f.D(.1)).A,this.S=this.S.j(this.T.C(this.S)._(.5)).U()},t.prototype.W=function(t){var h,n=this.u.j(this.S);50>n.x&&50>n.y&&(this.N=!1,this.P=255),0>n.x||n.x>500||0>n.y||n.y>375?this.X():(h=n.trunc(),1!==t[i.H(h)]?(2!==t[i.H(h)]||this.N||(t[i.H(h)]=0,this.N=!0,this.P=255,this.X()),this.u=new f(i.J(n.x,0,500),i.J(n.y,0,375)),this.R=0):this.X())},t.prototype.X=function(){this.u=this.u.C(this.S),this.T=f.q,this.R++,this.R>100&&(this.u=new f(20,20))},t.prototype.Y=function(t){var h=i.H(this.u);t[h]=Math.max(t[h],Math.trunc(this.P))},t.prototype.Z=function(){this.P=Math.max(0,this.P-.125)},t.$=()=>{var t,i,h,n,s,e,o,r=[];for(t=-20;20>=t;t++)for(i=-20;20>=i;i++)Math.pow(t,2)+Math.pow(i,2)>400||r.push(new f(t,i));for(h=r.length,n=new Int8Array(h),s=new Int8Array(h),e=0;h>e;e++)n[e]=(o=r[e]).x,s[e]=o.y;return{tt:r,size:h,dx:n,dy:s}},t.view=t.$(),t}(),w=function(){function t(){this.it=[];for(var t=0;1e3>t;t++)this.it.push(new c(new f(25,25),f.D()));this.ht=new Uint8ClampedArray(187500),this.nt=new Uint8ClampedArray(187500),this.st=new Uint8Array(187500)}return t.prototype.update=function(){this.et(),this.ot()},t.prototype.et=function(){for(var t=0;187500>t;t++)0===this.ht[t]&&0===this.nt[t]||Math.random()>=.005||(this.ht[t]=0,this.nt[t]=0)},t.prototype.ot=function(){var t,i;for(t=0;1e3>t;t++)(i=this.it[t]).V(i.N?this.ht:this.nt),i.W(this.st),i.Y(i.N?this.nt:this.ht),i.Z()},t.prototype.v=function(t,h,n){var s=this;i.L(t,h,((t,i)=>{var h=t+500*i;s.st[h]=n,s.ht[h]=0,s.nt[h]=0}))},t}(),M=function(){function t(t){this.canvas=document.getElementById(t),this.rt=this.canvas.getContext('2d'),this.at=new ImageData(500,500),this.h=new h(30,0),this.ut(),this.ft(),this.ct()}return t.prototype.ut=function(){this.canvas.width=500,this.canvas.height=375,this.canvas.addEventListener('contextmenu',(t=>t.preventDefault())),this.canvas.addEventListener('wheel',(t=>t.preventDefault()))},t.prototype.ft=function(){for(var t=3;75e4>t;t+=4)this.at.data[t]=255},t.prototype.ct=function(){var t=this;this.canvas.addEventListener('wheel',(h=>{t.h.m=i.J(t.h.m-i.K(h.deltaY),0,100)}))},t.prototype.t=function(t){this.wt(t),this.Mt(t.it)},t.prototype.wt=function(t){var i,h,n=this.at.data;for(i=0;187500>i;i++)h=4*i,1===t.st[i]?(n[h]=100,n[h+1]=100,n[h+2]=100):2===t.st[i]?(n[h]=0,n[h+1]=0,n[h+2]=255):(n[h]=t.ht[i],n[h+1]=0,n[h+2]=t.nt[i]);this.rt.putImageData(this.at,0,0),this.rt.fillStyle='#ff0000',this.rt.fillRect(0,0,50,50)},t.prototype.Mt=function(t){var i,h,n;for(this.rt.strokeStyle='#ffffff',this.rt.beginPath(),i=0;1e3>i;i++)h=t[i].u,n=t[i].S.I(1.5),this.rt.moveTo(h.x-n.x,h.y-n.y),this.rt.lineTo(h.x+n.x,h.y+n.y);this.rt.stroke()},t.prototype.o=function(t){this.rt.strokeStyle='#999999',this.rt.beginPath(),this.rt.arc(t.x,t.y,this.h.m,0,2*Math.PI),this.rt.stroke(),this.rt.fillStyle='#ffffff',this.rt.fillText('brush: '+{0:'none',1:'wall',2:'food'}[this.h.i],10,365)},t}();h=function(){function t(t,i){this.m=t,this.i=i,this.ct()}return t.prototype.ct=function(){var t=this;document.getElementById('button_none').addEventListener('click',(()=>t.i=0)),document.getElementById('button_wall').addEventListener('click',(()=>t.i=1)),document.getElementById('button_food').addEventListener('click',(()=>t.i=2)),window.addEventListener('keydown',(i=>{switch(i.key){case'0':t.i=0;break;case'1':t.i=1;break;case'2':t.i=2}}))},t}(),r=0,a=0,window.addEventListener('load',(()=>{n=document.getElementById('p1'),s=new w,e=new M('canvas'),o=new u(e.canvas),document.getElementById('button_play').addEventListener('click',(()=>a++)),document.getElementById('button_pause').addEventListener('click',(()=>a=0)),t()})),u=function(){function t(t){this.element=t,this.u=f.q,this.M=!1,this.l=!1,this.dt()}return t.prototype.dt=function(){var t=this;this.element.addEventListener('mousedown',(i=>{t.M||(t.M=0===i.button),t.l||(t.l=2===i.button)})),window.addEventListener('mousemove',(i=>{var h=t.element.getBoundingClientRect();t.u=new f(i.clientX-h.left,i.clientY-h.top)})),window.addEventListener('mouseup',(i=>{t.M&&(t.M=!(0===i.button)),t.l&&(t.l=!(2===i.button))}))},t}()})();